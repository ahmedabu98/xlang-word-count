apply plugin: 'application'

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.apache.beam:beam-sdks-java-io-google-cloud-platform:2.47.0'
    implementation 'org.apache.beam:beam-sdks-java-expansion-service:2.47.0'
    compileOnly "com.google.auto.service:auto-service-annotations:1.0.1"
    annotationProcessor "com.google.auto.service:auto-service:1.0.1"

    runtimeOnly "org.slf4j:slf4j-jdk14:1.7.30"
}

task runExpansionService (type: JavaExec) {
    mainClass = "org.apache.beam.sdk.expansion.service.ExpansionService"

    // classpath at runtime plus the jar of this project generated by the gradle build
    classpath = project.files(sourceSets.main.runtimeClasspath, project(":").jar.archiveFile.get().asFile)
    args = [project.findProperty("expansionPort") ?: "8099"]
}
